import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# Selenium instellen met optioneel headless Chrome
options = Options()
#options.add_argument('--headless')
options.add_argument('--disable-gpu')
options.add_argument('--no-sandbox')

# Voeg een custom user agent toe
options.add_argument("user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) ")

driver = webdriver.Chrome(options=options)

hoofdgerecht = "https://www.ah.nl/producten/product/wi514003/dr-oetker-ristorante-pizza-salami"
nagerecht = "https://www.ah.nl/producten/product/wi209562/ola-raket"

def get_product_info(url):
    try:
        driver.get(url)

        # Accepteer cookies als aanwezig
        try:
            WebDriverWait(driver, 10).until(
                EC.element_to_be_clickable((By.CSS_SELECTOR, "button[data-testhook='accept-all-button']"))
            ).click()
        except:
            pass  # Geen cookie-banner gevonden

        # Wacht op de afbeelding
        WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.CSS_SELECTOR, "img[data-testhook='product-image']"))
        )

        # Titel
        try:
            title = driver.find_element(By.CSS_SELECTOR, "h1[data-testhook='product-title']").text.strip()
        except:
            title = "Titel niet gevonden"

        # Afbeelding
        try:
            image_tag = driver.find_element(By.CSS_SELECTOR, "img[data-testhook='product-image']")
            image_url = image_tag.get_attribute("src")
        except:
            image_url = "Afbeelding niet gevonden"

        # Prijs
        try:
            price = driver.find_element(By.CSS_SELECTOR, "[data-testhook='price-per-quantity']").text.strip()
        except:
            price = "Prijs niet gevonden"

        print(f"Product: {title}")
        print(f"Prijs  : {price}")
        print(f"Afbeelding: {image_url}")

    except Exception as e:
        print(f"Fout bij laden van productpagina: {e}")

if __name__ == "__main__":
    get_product_info(hoofdgerecht)
    get_product_info(nagerecht)
    driver.quit()
